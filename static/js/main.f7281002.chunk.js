(this["webpackJsonpreal-time-collab-editor"]=this["webpackJsonpreal-time-collab-editor"]||[]).push([[0],{63:function(e,t,n){},64:function(e,t,n){},65:function(e,t,n){},72:function(e,t,n){},74:function(e,t,n){},75:function(e,t,n){},76:function(e,t,n){},77:function(e,t,n){"use strict";n.r(t);var r=n(17),c=n.n(r),a=n(47),s=n.n(a),o=(n(63),n(15)),i=(n(64),n(65),n(6)),u=n(56),l=new i.d,d=new u.a("ws://localhost:8080","prosemirror",l),f=l.getXmlFragment("prosemirror");d.awareness.setLocalStateField("user",{color:function(){var e=["#ff0000","#0000ff","#008000","#ffff00","#ee82ee","#008833"],t=e[Math.floor(e.length*Math.random())],n=Array.from(d.awareness.getStates()).map((function(e){var t,n=Object(o.a)(e,2);n[0];return null===(t=n[1].user)||void 0===t?void 0:t.color}));if(1===n.length)return t;for(var r=0;r<e.length;r++)if(!n.includes(e[r]))return e[r];return t}()});var j=Object(r.createContext)({yProvider:d,yType:f});n(72);var b=n(9);var m=function(e){var t=e.user;return Object(b.jsx)("div",{className:"userAvatar",style:{backgroundColor:t.color},children:t.id.toString()})};var h=function(){var e=Object(r.useState)([]),t=Object(o.a)(e,2),n=t[0],c=t[1],a=Object(r.useContext)(j).yProvider;return Object(r.useEffect)((function(){var e=function(e){var t=Array.from(a.awareness.getStates()).map((function(e){var t=Object(o.a)(e,2),n=t[0],r=t[1];return Object.assign(r.user,{id:n})}));c(t)};return a.awareness.on("change",e),function(){return a.awareness.off("change",e)}}),[]),Object(b.jsx)("header",{className:"header",children:Array.from(n).map((function(e){return Object(b.jsx)(m,{user:e},e.id)}))})},v=Object(r.createContext)({users:new Map,setUsers:function(){}}),O=n(23),p=(n(74),n(53)),g=n(1),x={content:"text*",attrs:{id:{default:0},user:{default:{id:0,color:"#FFF"}},text:{default:""}},parseDOM:[{tag:"span.comment"}]},w={group:"inline",content:"inline* text*",inline:!0,selectable:!0,attrs:{color:{default:"#ff0000"}},toDOM:function(e,t){var n=document.createElement("span");return n.classList.add("highlight"),n.id=e.attrs.id,n.style.backgroundColor=e.attrs.color,n},parseDOM:[{tag:"span.highlight"}]},C=p.a.spec.nodes,k=p.a.spec.marks.append({highlight:w,comment:x}),y=new g.h({nodes:C,marks:k}),B=n(4),M=n(39),S=n(54),N=n(46),D=(n(75),n(83));var F=function(e){var t=e.editorActions,n=(e.view,Object(r.useState)("#ffff00")),c=Object(o.a)(n,2),a=c[0],s=(c[1],Object(r.useContext)(j).yProvider);return Object(b.jsxs)("div",{className:"menuBar",children:[Object(b.jsx)("button",{title:"Bold",style:{fontWeight:"bold"},className:"menuBtn",onClick:function(e){t.setMark("strong"),e.preventDefault()},children:"B"}),Object(b.jsx)("button",{title:"Italic",style:{fontStyle:"italic"},className:"menuBtn",onClick:function(e){t.setMark("em"),e.preventDefault()},children:"I"}),Object(b.jsx)("button",{title:"Paragraph",className:"menuBtn",onClick:function(e){t.setBlock("paragraph"),e.preventDefault()},children:"P"}),Object(b.jsx)("button",{title:"Header",className:"menuBtn",onClick:function(e){t.setBlock("heading"),e.preventDefault()},children:"H"}),Object(b.jsx)("button",{title:"Marker",className:"menuBtn",onClick:function(e){t.setMark("highlight",{color:a}),e.preventDefault()},children:"\ud83d\udd8c"}),Object(b.jsx)("button",{title:"Comment",className:"menuBtn",onClick:function(e){var n=s.awareness.getLocalState().user,r=prompt("Write Comment");t.setMark("comment",{id:Object(D.a)(),user:n,text:r}),e.preventDefault()},children:"\ud83d\udcac"})]})},E=n(49),P=n(81),L=n(82),A=n(3),H=n(5),I=n(33);n(76);var R=function(e){var t=e.parent,n=e.viewHost,c=e.user,a=e.text,s=Object(r.useState)(d()),i=Object(o.a)(s,2),u=i[0],l=i[1];return Object(r.useEffect)((function(){l(d());var e=function(e){l(d())};return window.addEventListener("resize",e),function(){return window.removeEventListener("resize",e)}}),[]),Object(b.jsx)("div",{style:Object(I.a)(Object(I.a)({},u),{},{borderColor:c.color}),className:"commentCard",children:a});function d(){return{top:t.getBoundingClientRect().top,left:n.current.getBoundingClientRect().left-210}}},T=function(){function e(t,n,r,c,a){Object(A.a)(this,e),this.node=void 0,this.dom=void 0,this.contentDOM=void 0,this.view=void 0,this.viewHost=void 0,this.portal=void 0,this.addComment=void 0,this.node=t,this.view=n,this.addComment=c,this.viewHost=a}return Object(H.a)(e,[{key:"init",value:function(){this.dom=document.createElement("span"),this.dom.classList.add("comment"),this.dom.id=this.node.attrs.id,this.dom.style.borderColor=this.node.attrs.user.color;var e=document.createElement("div");e.classList.add("comment-anchor"),document.body.append(e);var t=Object(a.createPortal)(Object(b.jsx)(R,{parent:this.dom,viewHost:this.viewHost,user:this.node.attrs.user,text:this.node.attrs.text}),e,this.node.attrs.id);return this.portal=t,this.addComment(t),this}}]),e}();var z=function(){var e=Object(r.useRef)(),t=Object(r.useRef)(),n=Object(r.useContext)(j),c=n.yProvider,a=n.yType,s=Object(r.useState)([]),i=Object(o.a)(s,2),u=i[0],l=i[1],d=function(e){u.push(e),l(Object(O.a)(u))};Object(r.useEffect)((function(){var n=B.b.create({schema:y,plugins:[Object(E.c)(a),Object(P.a)(c.awareness),Object(L.c)(),Object(S.a)({"mod-z":L.b,"mod-y":L.a}),Object(S.a)(N.a)]});t.current=new M.c(e.current,{state:n,nodeViews:{comment:function(t,n,r){return new T(t,n,r,d,e).init()}}});var r=t.current;return r.focus(),function(){return r.destroy()}}),[]),Object(r.useEffect)((function(){console.log(u)}),[u]);var f={setMark:function(e,n){var r=t.current;r.focus(),Object(N.c)(y.marks[e],n)(r.state,r.dispatch)},setBlock:function(e,n){var r=t.current;r.focus(),Object(N.b)(y.nodes[e],n)(r.state,r.dispatch)},wrapSelection:function(e,n){var r=t.current;r.focus(),Object(N.d)(y.nodes[e],n)(r.state,r.dispatch)}};return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)(F,{editorActions:f,view:t}),Object(b.jsx)("div",{className:"editor",ref:e}),u]})};var J=function(){return Object(b.jsx)(b.Fragment,{children:Object(b.jsx)(z,{})})};function U(){var e=Object(r.useState)(new Map),t=Object(o.a)(e,2),n=t[0],c=t[1];return Object(b.jsx)("div",{className:"App",children:Object(b.jsxs)(v.Provider,{value:{users:n,setUsers:c},children:[Object(b.jsx)(h,{}),Object(b.jsx)(J,{})]})})}var W=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,84)).then((function(t){var n=t.getCLS,r=t.getFID,c=t.getFCP,a=t.getLCP,s=t.getTTFB;n(e),r(e),c(e),a(e),s(e)}))};s.a.render(Object(b.jsx)(c.a.StrictMode,{children:Object(b.jsx)(U,{})}),document.getElementById("root")),W()}},[[77,1,2]]]);
//# sourceMappingURL=main.f7281002.chunk.js.map