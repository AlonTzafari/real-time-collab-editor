(this["webpackJsonpreal-time-collab-editor"]=this["webpackJsonpreal-time-collab-editor"]||[]).push([[0],{63:function(t,e,n){},64:function(t,e,n){},65:function(t,e,n){},72:function(t,e,n){},74:function(t,e,n){},75:function(t,e,n){},76:function(t,e,n){},77:function(t,e,n){"use strict";n.r(e);var r=n(20),c=n.n(r),o=n(47),a=n.n(o),s=(n(63),n(64),n(16)),i=(n(65),n(6)),u=n(56),l=new i.d,d=new u.a("ws://localhost:8080","prosemirror",l),f=l.getXmlFragment("prosemirror");d.awareness.setLocalStateField("user",{color:function(){var t=["#ff0000","#0000ff","#008000","#ffff00","#ee82ee","#008833"],e=t[Math.floor(t.length*Math.random())],n=Array.from(d.awareness.getStates()).map((function(t){var e,n=Object(s.a)(t,2);n[0];return null===(e=n[1].user)||void 0===e?void 0:e.color}));if(1===n.length)return e;for(var r=0;r<t.length;r++)if(!n.includes(t[r]))return t[r];return e}()});var m=Object(r.createContext)({yProvider:d,yType:f});n(72);var j=n(9);var b=function(t){var e=t.user;return Object(j.jsx)("div",{className:"userAvatar",style:{backgroundColor:e.color},children:e.id.toString()})};var h=function(){var t=Object(r.useState)([]),e=Object(s.a)(t,2),n=e[0],c=e[1],o=Object(r.useContext)(m).yProvider;return Object(r.useEffect)((function(){var t=function(t){var e=Array.from(o.awareness.getStates()).map((function(t){var e=Object(s.a)(t,2),n=e[0],r=e[1];return Object.assign(r.user,{id:n})}));c(e)};return o.awareness.on("change",t),function(){return o.awareness.off("change",t)}}),[]),Object(j.jsx)("header",{className:"header",children:Array.from(n).map((function(t){return Object(j.jsx)(b,{user:t},t.id)}))})},v=n(23),O=(n(74),n(53)),p=n(1),g={content:"text*",attrs:{id:{default:0},user:{default:{id:0,color:"#FFF"}},text:{default:""}},parseDOM:[{tag:"span.comment"}]},x={group:"inline",content:"inline* text*",inline:!0,selectable:!0,attrs:{color:{default:"#ff0000"}},toDOM:function(t,e){var n=document.createElement("span");return n.classList.add("highlight"),n.id=t.attrs.id,n.style.backgroundColor=t.attrs.color,n},parseDOM:[{tag:"span.highlight"}]},w=O.a.spec.nodes,C=O.a.spec.marks.append({highlight:x,comment:g}),k=new p.h({nodes:w,marks:C}),y=n(4),B=n(39),M=n(54),S=n(46),N=(n(75),n(83));var D=function(t){var e=t.editorActions,n=(t.view,Object(r.useState)("#ffff00")),c=Object(s.a)(n,2),o=c[0],a=(c[1],Object(r.useContext)(m).yProvider);return Object(j.jsxs)("div",{className:"menuBar",children:[Object(j.jsx)("button",{title:"Bold",style:{fontWeight:"bold"},className:"menuBtn",onClick:function(t){e.setMark("strong"),t.preventDefault()},children:"B"}),Object(j.jsx)("button",{title:"Italic",style:{fontStyle:"italic"},className:"menuBtn",onClick:function(t){e.setMark("em"),t.preventDefault()},children:"I"}),Object(j.jsx)("button",{title:"Paragraph",className:"menuBtn",onClick:function(t){e.setBlock("paragraph"),t.preventDefault()},children:"P"}),Object(j.jsx)("button",{title:"Header",className:"menuBtn",onClick:function(t){e.setBlock("heading"),t.preventDefault()},children:"H"}),Object(j.jsx)("button",{title:"Marker",className:"menuBtn",onClick:function(t){e.setMark("highlight",{color:o}),t.preventDefault()},children:"\ud83d\udd8c"}),Object(j.jsx)("button",{title:"Comment",className:"menuBtn",onClick:function(t){var n=a.awareness.getLocalState().user,r=prompt("Write Comment");e.setMark("comment",{id:Object(N.a)(),user:n,text:r}),t.preventDefault()},children:"\ud83d\udcac"})]})},F=n(49),E=n(81),L=n(82),P=n(3),A=n(5),H=n(33);n(76);var I=function(t){var e=t.parent,n=t.viewHost,c=t.user,o=t.text,a=Object(r.useState)(d()),i=Object(s.a)(a,2),u=i[0],l=i[1];return Object(r.useEffect)((function(){l(d());var t=function(t){l(d())};return window.addEventListener("resize",t),function(){return window.removeEventListener("resize",t)}}),[]),Object(j.jsx)("div",{style:Object(H.a)(Object(H.a)({},u),{},{borderColor:c.color}),className:"commentCard",children:o});function d(){return{top:e.getBoundingClientRect().top,left:n.current.getBoundingClientRect().left-210}}},R=function(){function t(e,n,r,c,o){Object(P.a)(this,t),this.node=void 0,this.dom=void 0,this.contentDOM=void 0,this.view=void 0,this.viewHost=void 0,this.portal=void 0,this.addComment=void 0,this.node=e,this.view=n,this.addComment=c,this.viewHost=o}return Object(A.a)(t,[{key:"init",value:function(){this.dom=document.createElement("span"),this.dom.classList.add("comment"),this.dom.id=this.node.attrs.id,this.dom.style.borderColor=this.node.attrs.user.color;var t=document.createElement("div");t.classList.add("comment-anchor"),document.body.append(t);var e=Object(o.createPortal)(Object(j.jsx)(I,{parent:this.dom,viewHost:this.viewHost,user:this.node.attrs.user,text:this.node.attrs.text}),t,this.node.attrs.id);return this.portal=e,this.addComment(e),this}}]),t}();var T=function(){var t=Object(r.useRef)(),e=Object(r.useRef)(),n=Object(r.useContext)(m),c=n.yProvider,o=n.yType,a=Object(r.useState)([]),i=Object(s.a)(a,2),u=i[0],l=i[1],d=function(t){u.push(t),l(Object(v.a)(u))};Object(r.useEffect)((function(){var n=y.b.create({schema:k,plugins:[Object(F.c)(o),Object(E.a)(c.awareness),Object(L.c)(),Object(M.a)({"mod-z":L.b,"mod-y":L.a}),Object(M.a)(S.a)]});e.current=new B.c(t.current,{state:n,nodeViews:{comment:function(e,n,r){return new R(e,n,r,d,t).init()}}});var r=e.current;return r.focus(),function(){return r.destroy()}}),[]),Object(r.useEffect)((function(){console.log(u)}),[u]);var f={setMark:function(t,n){var r=e.current;r.focus(),Object(S.c)(k.marks[t],n)(r.state,r.dispatch)},setBlock:function(t,n){var r=e.current;r.focus(),Object(S.b)(k.nodes[t],n)(r.state,r.dispatch)},wrapSelection:function(t,n){var r=e.current;r.focus(),Object(S.d)(k.nodes[t],n)(r.state,r.dispatch)}};return Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)(D,{editorActions:f,view:e}),Object(j.jsx)("div",{className:"editor",ref:t}),u]})};var z=function(){return Object(j.jsx)(j.Fragment,{children:Object(j.jsx)(T,{})})};function J(){return Object(j.jsxs)("div",{className:"App",children:[Object(j.jsx)(h,{}),Object(j.jsx)(z,{})]})}var W=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,84)).then((function(e){var n=e.getCLS,r=e.getFID,c=e.getFCP,o=e.getLCP,a=e.getTTFB;n(t),r(t),c(t),o(t),a(t)}))};a.a.render(Object(j.jsx)(c.a.StrictMode,{children:Object(j.jsx)(J,{})}),document.getElementById("root")),W()}},[[77,1,2]]]);
//# sourceMappingURL=main.b0d16689.chunk.js.map